---
layout:     post
title:      (db)数据库事务管理（4）
subtitle:   乐观的并发控制规则
date:       2019-02-25
author:     Wenguangliu
header-img: img/post-bg-unix-linux.jpg
catalog: 	 true
tags:
    - 数据库
    - 事务
    - 乐观
    - 调度器
    - 时间戳
    - 有效性确认
---

前面文章介绍了悲观调度--基于锁的串行化调度，本文将介绍两种乐观串行化调度策略，即基于时间戳的并发控制和基于有效性确认的并发控制。

## 1. 基于时间戳
基于时间戳的并发控制会为每一个事务分配一个“时间戳”，并且记录每个数据库元素上一次读和写访问的时间戳，对于当前事务的时间戳与元素的访问时间戳进行比较，确保实际调度是一个可串行化的调度。首先，将介绍一下时间戳的生成。
### 1.1 时间戳
时间戳通过以下方法产生：
1. 采用系统时间作为时间戳，只要确保调度器在一个时钟周期内调度两个以上事务的；
2. 采用计数器，单调递增，作为事务的逻辑时间戳；

为了使用时间戳进行并发控制，在每一个数据库元素上需要两个时间戳和一个提交位，即：
1. RT(X)，X最近一次被读取的时间戳；
2. WT(X)，X最近一次被写入的时间戳；
3. C(X)， X的提交位，表示最近一次X的修改是否已经被提交；该位主要目的是避免U对X进行修改，T读取X，而U最后被中止的情况；

### 1.2 事实上不可实现的行为

 脏数据的问题

### 1.3 基于时间戳的调度规则

### 1.4 多版本时间戳

## 2. 基于有效性确认

### 2.1 有效性确认调度器的数据结构

### 2.2 有效性确认规则

## 3. 总结

封锁：

时间戳：

有效性确认：
